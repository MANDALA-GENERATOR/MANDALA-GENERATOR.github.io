<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <title>יוצר מנדלות אונליין</title>
  <style>
    body {
      margin: 0;
      display: flex;
      flex-direction: column; /* סידור מלמעלה למטה */
      justify-content: center;
      align-items: center;
      height: 100vh;
      background-color: #f4f4f4;
      font-family: Arial, sans-serif;
      gap: 40px;
    }
    .canvas-container {
      position: relative;
      display: flex;
      justify-content: center;
      align-items: flex-start;
    }
    canvas {
      border-radius: 50%;
      cursor: crosshair;
    }
    svg {
      position: absolute;
      top: 0;
      left: 0;
      pointer-events: none;
      width: 100%;
      height: 100%;
    }
    #controls {
      display: flex;
      flex-direction: column; /* סידור האלמנטים מלמעלה למטה */
      gap: 10px;
      background-color: #333;
      color: white;
      padding: 20px;
      border-radius: 10px;
      max-width: 300px;
      min-width: 200px;
    }
    #controls label {
      margin-bottom: 5px;
    }
    #controls input[type="color"],
    #controls input[type="range"] {
      width: 100%;
    }
    button {
      padding: 10px;
      border: none;
      border-radius: 5px;
      background-color: #555;
      color: white;
      cursor: pointer;
      font-size: 14px;
    }
    button:hover {
      background-color: #777;
    }
    #footer {
      margin-top: 20px;
      font-family: Arial, sans-serif;
      font-size: 14px;
      color: #333;
      text-align: center;
      position: relative;
      bottom: 0;
      left: 0;
      width: 100%; /* יתפוס את כל רוחב המסך */
      background-color: #f4f4f4; /* צבע רקע לדף */
      padding: 10px 0; /* רווחים סביב הטקסט */
      box-sizing: border-box; /* יכלול את הרווחים בתוך הגודל הכללי */
    }
    /* מיקום קבוע של הכפתור בפינה השמאלית התחתונה */
    .floating-button {
      position: fixed; /* הכפתור צף */
      bottom: 20px; /* מרחק מהתחתית */
      left: 20px; /* מרחק מהצד השמאלי */
      background-color: #333;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
      cursor: pointer;
      z-index: 1000; /* הכפתור יישאר מעל כל האלמנטים האחרים */
    }

    .floating-button:hover {
      background-color: #555;
    }

    .material-icons {
      font-size: 28px;
      color: white;
    }
  </style>
</head>
<body>
  <div class="canvas-container">
    <canvas id="mandalaCanvas" width="600" height="600"></canvas>
    <svg id="overlay"></svg>
  </div>
  <div id="controls">
    <label>רוחב קנבס:
      <input type="number" id="canvasWidth" value="600" min="100">
    </label>
    <label>צורת קנבס:
      <input type="radio" name="canvasShape" value="circle" checked> עיגול
      <input type="radio" name="canvasShape" value="square"> ריבוע
    </label>
    <label>גובה קנבס:
      <input type="number" id="canvasHeight" value="600" min="100">
    </label>
    <button id="resizeCanvas">שנה גודל</button>
    <label>צבע קו:
      <input type="color" id="colorPicker" value="#000000">
    </label>
    <label>צבע רקע:
      <input type="color" id="bgColorPicker" value="#ffffff">
    </label>
    <label>חלקים:
      <input type="range" id="sectors" min="4" max="32" value="16">
    </label>
    <label>עובי הקו:
      <input type="range" id="lineWidth" min="1" max="10" value="2">
    </label>
    <label>
      <input type="checkbox" id="mirror" checked> סימטריה
      <input type="checkbox" id="transparency" checked> רקע שקוף
    </label>
    <button id="clearCanvas">ניקוי</button>
    <button id="undoAction">ביטול פעולה אחרונה</button>
    <button id="redoAction">חזור על פעולה שבוטלה</button>
    <button id="saveImage">שמור</button>
  </div>
  <div id="footer">
    <p>1. יוצר המנדלות עובד בצורה אופטימלית במחשב.</p>
    <p>2. לשימוש בטלפון, יש להפעיל את מצב המחשב בדפדפן.</p>
    <p>3. שינויים בגודל הקנבס יגרמו למחיקת כל הציורים שבוצעו.</p>
    <p>© כל הזכויות שמורות - יוצר מנדלות</p>
  </div>
  <div id="shareButton" class="floating-button">
    <span class="material-icons">share</span>
  </div>
  <script>
    // כל הקוד נשאר אותו דבר, אין שינוי בקוד JavaScript
    // שמירה של מצב הקנבס לפני כל פעולה
    function saveState() {
      undoStack.push(ctx.getImageData(0, 0, canvas.width, canvas.height));
      redoStack = []; // לאחר שמירה של מצב חדש, רוקן את redoStack
    }
    // הוספת מאזין לשינוי צורה
    shapeRadios.forEach(radio => {
      radio.addEventListener("change", updateCanvasShape);
    });

    // הפעלת העדכון בעת הטעינה הראשונית
    updateCanvasShape();
  </script>
</body>
</html>
